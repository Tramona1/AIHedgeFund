(()=>{var e={};e.id=259,e.ids=[259],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},91645:e=>{"use strict";e.exports=require("net")},33873:e=>{"use strict";e.exports=require("path")},19771:e=>{"use strict";e.exports=require("process")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},34631:e=>{"use strict";e.exports=require("tls")},79551:e=>{"use strict";e.exports=require("url")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},4573:e=>{"use strict";e.exports=require("node:buffer")},77598:e=>{"use strict";e.exports=require("node:crypto")},73024:e=>{"use strict";e.exports=require("node:fs")},37067:e=>{"use strict";e.exports=require("node:http")},44708:e=>{"use strict";e.exports=require("node:https")},77030:e=>{"use strict";e.exports=require("node:net")},76760:e=>{"use strict";e.exports=require("node:path")},1708:e=>{"use strict";e.exports=require("node:process")},57075:e=>{"use strict";e.exports=require("node:stream")},37830:e=>{"use strict";e.exports=require("node:stream/web")},73136:e=>{"use strict";e.exports=require("node:url")},57975:e=>{"use strict";e.exports=require("node:util")},38522:e=>{"use strict";e.exports=require("node:zlib")},6234:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>d,pages:()=>u,routeModule:()=>p,tree:()=>c});var s=t(1189),a=t(21538),o=t(46156),n=t.n(o),i=t(67035),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(r,l);let c=["",{children:["preferences",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,82476)),"/Users/blakesingleton/Desktop/AIHedgeFund/apps/web/src/app/preferences/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,86346)),"/Users/blakesingleton/Desktop/AIHedgeFund/apps/web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,20520,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,87777,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,58686,23)),"next/dist/client/components/unauthorized-error"]}],u=["/Users/blakesingleton/Desktop/AIHedgeFund/apps/web/src/app/preferences/page.tsx"],d={require:t,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/preferences/page",pathname:"/preferences",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},74752:(e,r,t)=>{Promise.resolve().then(t.bind(t,82476))},38304:(e,r,t)=>{Promise.resolve().then(t.bind(t,47208))},47208:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var s=t(44079),a=t(73706),o=t(2132),n=t(26377),i=t(40887);function l(){let[e,r]=(0,a.useState)({tickers:[],sectors:[],tradingStyle:"Growth",updateFrequency:"daily",customTriggers:{}}),[t,l]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[d,p]=(0,a.useState)(!1),[m,g]=(0,a.useState)(!0),[x,h]=(0,a.useState)(null),{isLoaded:f,user:b}=(0,i.Jd)(),y=async r=>{if(r.preventDefault(),f&&b){p(!0),h(null);try{let r={userId:b.id,email:b.emailAddresses[0]?.emailAddress||"",tickers:e.tickers||[],sectors:e.sectors||[],tradingStyle:e.tradingStyle||"Growth",updateFrequency:e.updateFrequency||"daily",customTriggers:e.customTriggers||{}};await n.Aj.update(r),h({type:"success",message:"Your preferences have been saved successfully."})}catch(r){console.error("Error saving preferences:",r);let e="Failed to save preferences. Please try again.";r.message?.includes("Network error")?e="Network connection issue. Please check your internet connection and ensure the API server is running.":r.message?.includes("API error")&&(e=`Server error: ${r.message}. Please try again later.`),h({type:"error",message:e})}finally{p(!1)}}},v=t=>{r({...e,tickers:e.tickers?.filter(e=>e!==t)||[]})},k=t=>{r({...e,sectors:e.sectors?.filter(e=>e!==t)||[]})};return!f||m?(0,s.jsx)("div",{className:"container mx-auto px-4 py-8 flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"User Preferences"}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6 mb-8",children:(0,s.jsxs)("form",{onSubmit:y,children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),(0,s.jsx)("input",{type:"email",id:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:b?.emailAddresses[0]?.emailAddress||"",disabled:!0}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Email address cannot be changed here."})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"tradingStyle",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Trading Style"}),(0,s.jsxs)("select",{id:"tradingStyle",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:e.tradingStyle,onChange:t=>r({...e,tradingStyle:t.target.value}),children:[(0,s.jsx)("option",{value:"Growth",children:"Growth"}),(0,s.jsx)("option",{value:"Value",children:"Value"}),(0,s.jsx)("option",{value:"Momentum",children:"Momentum"}),(0,s.jsx)("option",{value:"Dividend",children:"Dividend"}),(0,s.jsx)("option",{value:"Day Trading",children:"Day Trading"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Update Frequency"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsxs)("label",{className:"inline-flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"updateFrequency",value:"realtime",checked:"realtime"===e.updateFrequency,onChange:()=>r({...e,updateFrequency:"realtime"}),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"ml-2",children:"Real-time"})]}),(0,s.jsxs)("label",{className:"inline-flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"updateFrequency",value:"daily",checked:"daily"===e.updateFrequency,onChange:()=>r({...e,updateFrequency:"daily"}),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"ml-2",children:"Daily Digest"})]}),(0,s.jsxs)("label",{className:"inline-flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"updateFrequency",value:"weekly",checked:"weekly"===e.updateFrequency,onChange:()=>r({...e,updateFrequency:"weekly"}),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"ml-2",children:"Weekly Summary"})]})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Watchlist Tickers"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:e.tickers&&e.tickers.map(e=>(0,s.jsxs)("div",{className:"inline-flex items-center bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full",children:[e,(0,s.jsx)("button",{type:"button",onClick:()=>v(e),className:"ml-1 text-blue-600 hover:text-blue-800",children:"\xd7"})]},e))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",className:"flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Add ticker (e.g., GOOG)",value:t,onChange:e=>l(e.target.value.toUpperCase())}),(0,s.jsx)(o.$,{type:"button",onClick:()=>{t&&!e.tickers?.includes(t)&&(r({...e,tickers:[...e.tickers||[],t]}),l(""))},children:"Add"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sectors of Interest"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:e.sectors&&e.sectors.map(e=>(0,s.jsxs)("div",{className:"inline-flex items-center bg-green-100 text-green-800 text-sm px-3 py-1 rounded-full",children:[e,(0,s.jsx)("button",{type:"button",onClick:()=>k(e),className:"ml-1 text-green-600 hover:text-green-800",children:"\xd7"})]},e))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",className:"flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Add sector (e.g., Energy)",value:c,onChange:e=>u(e.target.value)}),(0,s.jsx)(o.$,{type:"button",onClick:()=>{c&&!e.sectors?.includes(c)&&(r({...e,sectors:[...e.sectors||[],c]}),u(""))},children:"Add"})]})]}),x&&(0,s.jsx)("div",{className:`mb-4 p-3 rounded ${"success"===x.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:x.message}),(0,s.jsx)(o.$,{type:"submit",disabled:d,children:d?"Saving...":"Save Preferences"})]})})]})}},26377:(e,r,t)=>{"use strict";t.d(r,{pu:()=>p,p5:()=>m,tD:()=>c,VX:()=>u,Aj:()=>d});var s=t(55368);let a=null,o=process.env.NEXT_PUBLIC_SUPABASE_URL||"",n=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"";if(o&&n&&!o.includes("your-supabase-url")&&!n.includes("your-supabase-anon-key"))try{a=(0,s.UU)(o,n),console.log("Supabase client initialized for database operations")}catch(e){console.error("Failed to initialize Supabase client:",e),a={from:()=>(console.error("Supabase client not properly initialized"),{select:()=>Promise.resolve([]),insert:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")}),update:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")}),delete:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")})})}}else console.warn("Supabase URL or API key not properly configured"),a={from:()=>(console.error("Supabase client not properly initialized"),{select:()=>Promise.resolve([]),insert:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")}),update:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")}),delete:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")})})};let i=process.env.NEXT_PUBLIC_API_URL?process.env.NEXT_PUBLIC_API_URL:"http://localhost:3002";async function l(e,r={}){let t=`${i}${e}`;try{console.log(`Fetching from: ${t}`);let e=new AbortController,s=setTimeout(()=>e.abort(),3e4),a=await fetch(t,{...r,headers:{"Content-Type":"application/json",...r.headers},signal:e.signal});if(clearTimeout(s),!a.ok){let e;try{e=await a.json()}catch(r){e={message:`HTTP error ${a.status}`}}throw Error(e.message||`API error: ${a.status}`)}return a.json()}catch(e){if(console.error(`Failed to fetch from ${t}:`,e),e instanceof TypeError&&"Failed to fetch"===e.message)return console.warn("API connection error: could not connect to server"),{error:"API_CONNECTION_ERROR",message:"Could not connect to the server. Please check your internet connection or try again later.",success:!1,status:"error"};if(e instanceof DOMException&&"AbortError"===e.name)return console.warn("API timeout error: request took too long"),{error:"API_TIMEOUT",message:"Request timed out. The server is taking too long to respond.",success:!1,status:"error"};if(e instanceof Error)return{error:"API_ERROR",message:e.message||"An unknown error occurred",success:!1,status:"error"};return{error:"UNKNOWN_ERROR",message:"An unexpected error occurred",success:!1,status:"error"}}}let c={async getStockData(e){try{let r=e.toUpperCase(),{data:t,error:s}=await a.from("market_data").select("*").eq("ticker",r).order("timestamp",{ascending:!1}).limit(1).single();if(s)return console.error(`Error fetching stock data for ${e} from Supabase:`,s),null;if(t)return{symbol:t.ticker,price:t.price||0,change:t.price_change||0,changePercent:t.price_change_pct||0,volume:t.volume||0,lastUpdated:new Date(t.timestamp)};return null}catch(r){return console.error(`Error fetching stock data for ${e}:`,r),null}},async getBatchStockData(e){if(!e||0===e.length)return{};try{let r=e.map(e=>e.toUpperCase()),{data:t,error:s}=await a.from("market_data").select("*").in("ticker",r).order("timestamp",{ascending:!1});if(s)return console.error("Error fetching batch stock data from Supabase:",s),{};let o={};if(t&&t.length>0){let e={};t.forEach(r=>{let t=r.ticker;(!e[t]||new Date(r.timestamp)>new Date(e[t].timestamp))&&(e[t]=r)}),Object.values(e).forEach(e=>{o[e.ticker]={symbol:e.ticker,price:e.price||0,change:e.price_change||0,changePercent:e.price_change_pct||0,volume:e.volume||0,lastUpdated:new Date(e.timestamp)}})}return o}catch(e){return console.error("Error fetching batch stock data:",e),{}}}},u={getAll:()=>l("/api/updates"),getByTicker:e=>l(`/api/updates/ticker/${e}`),create:e=>l("/api/updates",{method:"POST",body:JSON.stringify(e)})},d={async get(e){try{if(!e)return console.warn("Attempted to fetch user preferences without a user ID"),{userPreferences:null};return await l(`/api/users/${e}/preferences`)}catch(e){return console.error("Error fetching user preferences:",e),e instanceof Error&&"User not found"===e.message&&console.log("This appears to be a new user - returning empty preferences"),{userPreferences:null}}},async update(e){try{let r=null;for(let t=1;t<=3;t++)try{return await l("/api/users/preferences",{method:"POST",body:JSON.stringify(e)})}catch(e){if(console.log(`API call attempt ${t} failed:`,e),r=e,!(e instanceof TypeError)||3===t)throw e;await new Promise(e=>setTimeout(e,1e3*t))}throw r}catch(e){throw console.error("Error updating user preferences:",e),e}}},p={getRecent:(e=10)=>l(`/api/economic-reports/recent?limit=${e}`),getBySource:(e,r=10)=>l(`/api/economic-reports/recent?source=${e}&limit=${r}`),getByCategory:(e,r=10)=>l(`/api/economic-reports/recent?category=${e}&limit=${r}`),getSources:()=>l("/api/economic-reports/sources"),getCategories:()=>l("/api/economic-reports/categories")},m={getRecent:(e=10)=>l(`/api/interviews/recent?limit=${e}`),getBySpeaker:(e,r=10)=>l(`/api/interviews/recent?speaker=${e}&limit=${r}`),getSpeakers:()=>l("/api/interviews/speakers")}},82476:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(41797).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/blakesingleton/Desktop/AIHedgeFund/apps/web/src/app/preferences/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/blakesingleton/Desktop/AIHedgeFund/apps/web/src/app/preferences/page.tsx","default")}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[26,113,857,368,470],()=>t(6234));module.exports=s})();