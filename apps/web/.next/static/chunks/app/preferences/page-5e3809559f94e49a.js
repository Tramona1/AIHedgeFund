(globalThis.webpackChunk_N_E=globalThis.webpackChunk_N_E||[]).push([[259],{36024:(e,r,t)=>{Promise.resolve().then(t.bind(t,60168))},60168:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(78882),a=t(23722),n=t(13620),o=t(59224),i=t(52451);function c(){var e;let[r,t]=(0,a.useState)({tickers:[],sectors:[],tradingStyle:"Growth",updateFrequency:"daily",customTriggers:{}}),[c,l]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[m,p]=(0,a.useState)(!1),[g,h]=(0,a.useState)(!0),[f,y]=(0,a.useState)(null),{isLoaded:b,user:v}=(0,i.Jd)();(0,a.useEffect)(()=>{async function e(){if(b&&v)try{h(!0);let e=await o.Aj.get(v.id);e.userPreferences&&t(e.userPreferences)}catch(e){console.error("Error loading user preferences:",e)}finally{h(!1)}}b&&e()},[b,v]);let x=async e=>{var t,s,a;if(e.preventDefault(),b&&v){p(!0),y(null);try{let e={userId:v.id,email:(null===(t=v.emailAddresses[0])||void 0===t?void 0:t.emailAddress)||"",tickers:r.tickers||[],sectors:r.sectors||[],tradingStyle:r.tradingStyle||"Growth",updateFrequency:r.updateFrequency||"daily",customTriggers:r.customTriggers||{}};await o.Aj.update(e),y({type:"success",message:"Your preferences have been saved successfully."})}catch(r){console.error("Error saving preferences:",r);let e="Failed to save preferences. Please try again.";(null===(s=r.message)||void 0===s?void 0:s.includes("Network error"))?e="Network connection issue. Please check your internet connection and ensure the API server is running.":(null===(a=r.message)||void 0===a?void 0:a.includes("API error"))&&(e="Server error: ".concat(r.message,". Please try again later.")),y({type:"error",message:e})}finally{p(!1)}}},k=e=>{var s;t({...r,tickers:(null===(s=r.tickers)||void 0===s?void 0:s.filter(r=>r!==e))||[]})},w=e=>{var s;t({...r,sectors:(null===(s=r.sectors)||void 0===s?void 0:s.filter(r=>r!==e))||[]})};return!b||g?(0,s.jsx)("div",{className:"container mx-auto px-4 py-8 flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"User Preferences"}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-6 mb-8",children:(0,s.jsxs)("form",{onSubmit:x,children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),(0,s.jsx)("input",{type:"email",id:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:(null==v?void 0:null===(e=v.emailAddresses[0])||void 0===e?void 0:e.emailAddress)||"",disabled:!0}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Email address cannot be changed here."})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{htmlFor:"tradingStyle",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Trading Style"}),(0,s.jsxs)("select",{id:"tradingStyle",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:r.tradingStyle,onChange:e=>t({...r,tradingStyle:e.target.value}),children:[(0,s.jsx)("option",{value:"Growth",children:"Growth"}),(0,s.jsx)("option",{value:"Value",children:"Value"}),(0,s.jsx)("option",{value:"Momentum",children:"Momentum"}),(0,s.jsx)("option",{value:"Dividend",children:"Dividend"}),(0,s.jsx)("option",{value:"Day Trading",children:"Day Trading"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Update Frequency"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsxs)("label",{className:"inline-flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"updateFrequency",value:"realtime",checked:"realtime"===r.updateFrequency,onChange:()=>t({...r,updateFrequency:"realtime"}),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"ml-2",children:"Real-time"})]}),(0,s.jsxs)("label",{className:"inline-flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"updateFrequency",value:"daily",checked:"daily"===r.updateFrequency,onChange:()=>t({...r,updateFrequency:"daily"}),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"ml-2",children:"Daily Digest"})]}),(0,s.jsxs)("label",{className:"inline-flex items-center",children:[(0,s.jsx)("input",{type:"radio",name:"updateFrequency",value:"weekly",checked:"weekly"===r.updateFrequency,onChange:()=>t({...r,updateFrequency:"weekly"}),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"ml-2",children:"Weekly Summary"})]})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Watchlist Tickers"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:r.tickers&&r.tickers.map(e=>(0,s.jsxs)("div",{className:"inline-flex items-center bg-blue-100 text-blue-800 text-sm px-3 py-1 rounded-full",children:[e,(0,s.jsx)("button",{type:"button",onClick:()=>k(e),className:"ml-1 text-blue-600 hover:text-blue-800",children:"\xd7"})]},e))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",className:"flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Add ticker (e.g., GOOG)",value:c,onChange:e=>l(e.target.value.toUpperCase())}),(0,s.jsx)(n.$,{type:"button",onClick:()=>{var e;!c||(null===(e=r.tickers)||void 0===e?void 0:e.includes(c))||(t({...r,tickers:[...r.tickers||[],c]}),l(""))},children:"Add"})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sectors of Interest"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:r.sectors&&r.sectors.map(e=>(0,s.jsxs)("div",{className:"inline-flex items-center bg-green-100 text-green-800 text-sm px-3 py-1 rounded-full",children:[e,(0,s.jsx)("button",{type:"button",onClick:()=>w(e),className:"ml-1 text-green-600 hover:text-green-800",children:"\xd7"})]},e))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",className:"flex-grow px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Add sector (e.g., Energy)",value:d,onChange:e=>u(e.target.value)}),(0,s.jsx)(n.$,{type:"button",onClick:()=>{var e;!d||(null===(e=r.sectors)||void 0===e?void 0:e.includes(d))||(t({...r,sectors:[...r.sectors||[],d]}),u(""))},children:"Add"})]})]}),f&&(0,s.jsx)("div",{className:"mb-4 p-3 rounded ".concat("success"===f.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:f.message}),(0,s.jsx)(n.$,{type:"submit",disabled:m,children:m?"Saving...":"Save Preferences"})]})})]})}},13620:(e,r,t)=>{"use strict";t.d(r,{$:()=>l});var s=t(78882),a=t(23722),n=t(29610),o=t(93102),i=t(59683);let c=(0,o.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,r)=>{let{className:t,variant:a,size:o,asChild:l=!1,...d}=e,u=l?n.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(c({variant:a,size:o,className:t})),ref:r,...d})});l.displayName="Button"},59224:(e,r,t)=>{"use strict";t.d(r,{pu:()=>g,p5:()=>h,tD:()=>u,VX:()=>m,Aj:()=>p});var s=t(79021),a=t(37811);let n=null,o=a.env.NEXT_PUBLIC_SUPABASE_URL||"",i=a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"";if(o&&i&&!o.includes("your-supabase-url")&&!i.includes("your-supabase-anon-key"))try{n=(0,s.UU)(o,i),console.log("Supabase client initialized for database operations")}catch(e){console.error("Failed to initialize Supabase client:",e),n={from:()=>(console.error("Supabase client not properly initialized"),{select:()=>Promise.resolve([]),insert:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")}),update:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")}),delete:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")})})}}else console.warn("Supabase URL or API key not properly configured"),n={from:()=>(console.error("Supabase client not properly initialized"),{select:()=>Promise.resolve([]),insert:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")}),update:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")}),delete:()=>Promise.resolve({data:null,error:Error("Supabase not initialized")})})};var c=t(37811);let l=(()=>{if(c.env.NEXT_PUBLIC_API_URL)return c.env.NEXT_PUBLIC_API_URL;{let e=window.location.hostname;return"http://".concat(e,":3002")}})();async function d(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat(l).concat(e);try{console.log("Fetching from: ".concat(t));let e=new AbortController,s=setTimeout(()=>e.abort(),3e4),a=await fetch(t,{...r,headers:{"Content-Type":"application/json",...r.headers},signal:e.signal});if(clearTimeout(s),!a.ok){let e;try{e=await a.json()}catch(r){e={message:"HTTP error ".concat(a.status)}}throw Error(e.message||"API error: ".concat(a.status))}return a.json()}catch(e){if(console.error("Failed to fetch from ".concat(t,":"),e),e instanceof TypeError&&"Failed to fetch"===e.message)return console.warn("API connection error: could not connect to server"),{error:"API_CONNECTION_ERROR",message:"Could not connect to the server. Please check your internet connection or try again later.",success:!1,status:"error"};if(e instanceof DOMException&&"AbortError"===e.name)return console.warn("API timeout error: request took too long"),{error:"API_TIMEOUT",message:"Request timed out. The server is taking too long to respond.",success:!1,status:"error"};if(e instanceof Error)return{error:"API_ERROR",message:e.message||"An unknown error occurred",success:!1,status:"error"};return{error:"UNKNOWN_ERROR",message:"An unexpected error occurred",success:!1,status:"error"}}}let u={async getStockData(e){try{let r=e.toUpperCase(),{data:t,error:s}=await n.from("market_data").select("*").eq("ticker",r).order("timestamp",{ascending:!1}).limit(1).single();if(s)return console.error("Error fetching stock data for ".concat(e," from Supabase:"),s),null;if(t)return{symbol:t.ticker,price:t.price||0,change:t.price_change||0,changePercent:t.price_change_pct||0,volume:t.volume||0,lastUpdated:new Date(t.timestamp)};return null}catch(r){return console.error("Error fetching stock data for ".concat(e,":"),r),null}},async getBatchStockData(e){if(!e||0===e.length)return{};try{let r=e.map(e=>e.toUpperCase()),{data:t,error:s}=await n.from("market_data").select("*").in("ticker",r).order("timestamp",{ascending:!1});if(s)return console.error("Error fetching batch stock data from Supabase:",s),{};let a={};if(t&&t.length>0){let e={};t.forEach(r=>{let t=r.ticker;(!e[t]||new Date(r.timestamp)>new Date(e[t].timestamp))&&(e[t]=r)}),Object.values(e).forEach(e=>{a[e.ticker]={symbol:e.ticker,price:e.price||0,change:e.price_change||0,changePercent:e.price_change_pct||0,volume:e.volume||0,lastUpdated:new Date(e.timestamp)}})}return a}catch(e){return console.error("Error fetching batch stock data:",e),{}}}},m={getAll:()=>d("/api/updates"),getByTicker:e=>d("/api/updates/ticker/".concat(e)),create:e=>d("/api/updates",{method:"POST",body:JSON.stringify(e)})},p={async get(e){try{if(!e)return console.warn("Attempted to fetch user preferences without a user ID"),{userPreferences:null};return await d("/api/users/".concat(e,"/preferences"))}catch(e){return console.error("Error fetching user preferences:",e),e instanceof Error&&"User not found"===e.message&&console.log("This appears to be a new user - returning empty preferences"),{userPreferences:null}}},async update(e){try{let r=null;for(let t=1;t<=3;t++)try{return await d("/api/users/preferences",{method:"POST",body:JSON.stringify(e)})}catch(e){if(console.log("API call attempt ".concat(t," failed:"),e),r=e,!(e instanceof TypeError)||3===t)throw e;await new Promise(e=>setTimeout(e,1e3*t))}throw r}catch(e){throw console.error("Error updating user preferences:",e),e}}},g={getRecent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return d("/api/economic-reports/recent?limit=".concat(e))},getBySource:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return d("/api/economic-reports/recent?source=".concat(e,"&limit=").concat(r))},getByCategory:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return d("/api/economic-reports/recent?category=".concat(e,"&limit=").concat(r))},getSources:()=>d("/api/economic-reports/sources"),getCategories:()=>d("/api/economic-reports/categories")},h={getRecent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return d("/api/interviews/recent?limit=".concat(e))},getBySpeaker:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return d("/api/interviews/recent?speaker=".concat(e,"&limit=").concat(r))},getSpeakers:()=>d("/api/interviews/speakers")}},59683:(e,r,t)=>{"use strict";t.d(r,{cn:()=>n});var s=t(53036),a=t(89257);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,s.$)(r))}}},e=>{var r=r=>e(e.s=r);e.O(0,[656,451,183,722,358],()=>r(36024)),_N_E=e.O()}]);